[[_rgant-PersistenceCapable]]
= `@PersistenceCapable` (`javax.jdo`)
:Notice: Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at. http://www.apache.org/licenses/LICENSE-2.0 . Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR  CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
:_basedir: ../
:_imagesdir: images/



The `@javax.jdo.annotation.PersistenceCapable` is used by JDO/DataNucleus to indicate that a class is a domain entity to be persisted to the database.

Apache Isis also checks for this annotation, and if the `@PersistenceCapable#schema()` attribute is present will use it to form the object type.

[NOTE]
====
Isis parses the `@PersistenceCapable` annotation from the Java source code; it does not query the JDO metamodel.  This means that it the `@PersistenceCapable` annotation must be used rather than the equivalent `<class>` link:http://www.datanucleus.org/products/accessplatform_4_0/jdo/class_mapping.html[XML metadata].

Moreover, while JDO/DataNucleus will recognize annotations on either the field or the getter method, Apache Isis (currently) only inspects the getter method.  Therefore ensure that the annotation is placed there.
====


The object type is used internally by Apache Isis to generate a string representation of an objects identity (the `Oid`).  This can appear in several contexts, including:

* as the value of `o.a.i.applib.services.bookmark.Bookmark#getObjectType()`
* in the `toString()` value of `Bookmark`
* in the URLs of the xref:ugvro.adoc#[RestfulObjects viewer]
* in the URLs of the xref:ugvw.adoc#[Wicket viewer] (in general and in particular if xref:ugvw.adoc#_ugvw_features_hints-and-copy-url[copying URLs])
* in XML snapshots generated by the xref:rgsvc.adoc#_rgsvc_api_XmlSnapshotService[`XmlSnapshotService`]


The actual format of the object type used by Apache Isis for the concatenation of `schema()` and `@PersistenceCapable#table()`.  If the `table()` is not present, then the class' simple name is used instead.

For example:

[source,java]
----
@javax.jdo.annotations.PersistenceCapable(schema="custmgmt")
public class Customer {
    ...
}
----

has an object type of `custmgmt.Customer`, while:

[source,java]
----
@javax.jdo.annotations.PersistenceCapable(schema="custmgmt", table="Address")
public class AddressImpl {
    ...
}
----

has an object type of `custmgmt.Address`.


On the other hand:

[source,java]
----
@javax.jdo.annotations.PersistenceCapable(table="Address")
public class AddressImpl {
    ...
}
----

does _not_ correspond to an object type, because the `schema()` attribute is missing.

If the object type has not been specified, then Apache Isis will use the fully qualified class name of the entity.



[TIP]
====
This might be obvious, but to make explicit: we recommend that you use namespaces of some form or other.

If the object type has not been specified (by either this annotation, or by xref:rgant.adoc#_rgant-Discriminator[`@Discriminator`], or by Apache Isis' own xref:rgant.adoc#_rgant-ObjectType[`@DomainObject#objectType()`] annotation/attribute), then (as noted above) Apache Isis will use the fully qualified class name of the entity.


However, chances are that the fully qualified class name is liable to change over time, for example if the code is refactored or (more fundamentally) if your company/organization reorganizes/renames itself/is acquired.

Isis' recognition of `@PersistenceCapable#schema()` makes namespacing of object types comparatively trivial, and moreover aligns the namespacing with the way in which the tables in the database are namespaced by the database schema.

We therefore strongly recommend that you specify an object type for all entities, one way or another.  Using `@PersistenceCapable#schema()` is probably the best choice in most cases.
====



[NOTE]
====
If the object type is not unique across all domain classes then the framework will fail-fast and fail to boot.  An error message will be printed in the log to help you determine which classes have duplicate object tyoes.
====
